<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title>Inventory Item</title>
</head>
<body>
<div th:replace="~{navbar :: navbar}"></div>
<a th:href="@{/inventory}">Back</a>
<h1 th:text="${item.name}"></h1>

<div th:if="${success}" class="alert alert-success" th:text="${success}"></div>
<div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>

<div>
    <p><strong>Category:</strong> <span th:text="${item.category}"></span></p>
    <p><strong>Quantity:</strong> <span th:text="${item.quantity}"></span> <span th:text="${item.unit}"></span></p>
    <p><strong>Low Threshold:</strong> <span th:text="${item.lowStockThreshold}"></span></p>
    <p><strong>Status:</strong>
        <span th:text="${item.lowStock ? 'LOW' : 'OK'}"></span>
    </p>
</div>

<h3>Edit</h3>
<form th:action="@{'/inventory/' + ${item.id} + '/edit'}" method="post">
    <div>
        <label>Category</label>
        <input type="text" name="category" th:value="${item.category}" maxlength="100" />
    </div>
    <div>
        <label>Unit</label>
        <input type="text" name="unit" th:value="${item.unit}" maxlength="20" required />
    </div>
    <div>
        <label>Low Stock Threshold</label>
        <input type="number" name="lowStockThreshold" th:value="${item.lowStockThreshold}" min="0" required />
    </div>
    <div>
        <button type="submit">Save</button>
    </div>
    </form>

<h3>Record Transaction</h3>
<form th:action="@{'/inventory/' + ${item.id} + '/tx'}" method="post">
    <div>
        <label>Type</label>
        <select name="type" required>
            <option value="IN">IN</option>
            <option value="OUT">OUT</option>
            <option value="ADJUSTMENT">ADJUSTMENT</option>
        </select>
    </div>
    <div>
        <label>Quantity</label>
        <input type="number" name="quantity" min="1" required />
    </div>
    <div>
        <label>Note</label>
        <input type="text" name="note" maxlength="255" />
    </div>
    <div>
        <label>By</label>
        <input type="text" name="createdBy" maxlength="100" />
    </div>
    <div>
        <button type="submit">Record</button>
    </div>
    </form>

<h3>Transactions</h3>
<table border="1" cellpadding="6" cellspacing="0">
    <thead>
    <tr>
        <th>Time</th>
        <th>Type</th>
        <th>Quantity</th>
        <th>Note</th>
        <th>By</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="t : ${transactions}">
        <td th:text="${#temporals.format(t.createdAt, 'yyyy-MM-dd HH:mm')}"></td>
        <td th:text="${t.type}"></td>
        <td th:text="${t.quantity}"></td>
        <td th:text="${t.note}"></td>
        <td th:text="${t.createdBy}"></td>
    </tr>
    </tbody>
    <tbody th:if="${transactions} == null or #lists.isEmpty(transactions)">
    <tr><td colspan="5">No transactions.</td></tr>
    </tbody>
    </table>

</body>
</html>


